<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: head('Restock Request')}"></head>
<body>
<div th:replace="~{fragments :: nav}"></div>

<div class="container py-4" style="max-width:900px;">
  <h1 class="h3 section-title mb-3"><i class="bi bi-truck me-2"></i>Restock Request</h1>

  <div class="card">
    <div class="card-body">

      <!-- SAME UI; dynamic action makes it work for both create & edit -->
      <form th:action="${isEdit} ? @{/staff/restock/{id}(id=${req.id})} : @{/staff/restock}"
            method="post"
            th:object="${req}"
            class="row g-3">

        <!-- Hidden fields -->
        <input type="hidden" th:if="${isEdit}" th:field="*{id}"/>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <!-- Vendor -->
        <div class="col-md-6">
          <label class="form-label">Vendor</label>
          <select class="form-select" th:field="*{vendorId}" required>
            <option value="" disabled th:if="${!isEdit}" selected>Select vendor</option>
            <option th:each="v : ${vendors}" th:value="${v.id}" th:text="${v.name}"></option>
          </select>
        </div>

        <!-- Product -->
        <div class="col-md-6">
          <label class="form-label">Product (Low on stock)</label>
          <select class="form-select" th:field="*{productId}" required>
            <option value="" disabled th:if="${!isEdit}" selected>Select product</option>
            <option th:each="p : ${products}" th:value="${p.id}"
                    th:text="${p.brand + ' ' + p.name + ' [' + p.skuId + ']'}"></option>
          </select>
        </div>

        <!-- Quantity -->
        <div class="col-md-4">
          <label class="form-label">Requested Quantity</label>
          <input class="form-control" type="number" min="1" th:field="*{requestedQty}" placeholder="10" required/>
        </div>

        <!-- Actions -->
        <div class="col-12 d-flex gap-2">
          <button class="btn btn-primary" type="submit">
            <i class="bi bi-save me-1"></i>
            <span th:text="${isEdit} ? 'Update' : 'Submit Request'">Submit Request</span>
          </button>

          <a class="btn btn-outline-secondary" th:href="@{/dashboard}">
            <i class="bi bi-x-circle me-1"></i>Cancel
          </a>
        </div>

      </form>
      <!-- /form -->

    </div>
  </div>

  <div class="alert alert-info mt-3">
    Choose the vendor and the item thatâ€™s running out of stock. Requests are saved as <b>PENDING</b>.
  </div>
</div>
</body>
</html>