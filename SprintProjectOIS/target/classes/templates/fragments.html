<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<!-- Fragment: Centralized Head -->
<head th:fragment="head(title)">
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title th:text="${title} + ' | CG-OIS'">CG-OIS</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
  <link th:href="@{/css/app.css}" rel="stylesheet"/>
</head>

<body>

<nav th:fragment="nav" class="navbar navbar-expand-lg">
  <div class="container-fluid">

    <a class="navbar-brand fw-bold d-flex align-items-center" th:href="@{/dashboard}">
      <i class="bi bi-bag-check-fill me-2 h4 mb-0 text-primary"></i> CG-OIS
    </a>

    <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="mainNav" class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto">

        <!-- Dashboard -->
        <li class="nav-item">
          <a class="nav-link" th:href="@{/dashboard}">
            <i class="bi bi-speedometer2 me-1"></i>Dashboard
          </a>
        </li>

        <!-- PUBLIC Categories -->
        <li class="nav-item">
          <a class="nav-link" th:href="@{/categories}">
            <i class="bi bi-grid me-1"></i>Categories
          </a>
        </li>

        <!-- ADMIN: Manage Categories -->
        <li class="nav-item" sec:authorize="hasRole('ADMIN')">
          <a class="nav-link text-primary fw-semibold" th:href="@{/admin/categories}">
            <i class="bi bi-collection me-1"></i>Manage Categories
          </a>
        </li>

        <!-- ADMIN: Manage Vendors -->
        <li class="nav-item" sec:authorize="hasRole('ADMIN')">
          <a class="nav-link text-primary fw-semibold" th:href="@{/admin/vendors}">
            <i class="bi bi-building me-1"></i>Manage Vendors
          </a>
        </li>

        <!-- ADMIN: Customers -->
        <li class="nav-item" sec:authorize="hasRole('ADMIN')">
          <a class="nav-link" th:href="@{/customers/list}">
            <i class="bi bi-people me-1"></i>Customers
          </a>
        </li>

        <!-- STAFF: Restock -->
        <li class="nav-item" sec:authorize="hasRole('STAFF')">
          <a class="nav-link text-success fw-semibold" th:href="@{/staff/restock/new}">
            <i class="bi bi-truck me-1"></i>Restock Request
          </a>
        </li>

        <!-- Orders -->
        <li class="nav-item">
          <a class="nav-link" th:href="@{/orders}">
            <i class="bi bi-receipt me-1"></i>Orders
          </a>
        </li>

      </ul>

      <!-- Logout -->
      <form th:action="@{/logout}" method="post" class="d-flex ms-lg-3">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button class="btn btn-sm btn-primary shadow-soft px-3 rounded-pill" type="submit">
          <i class="bi bi-box-arrow-right me-1"></i>Logout
        </button>
      </form>

    </div>
  </div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>