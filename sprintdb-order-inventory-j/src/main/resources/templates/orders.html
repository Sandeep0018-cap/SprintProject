<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: head('Orders')}"></head>
<body>
<div th:replace="~{fragments :: nav}"></div>

<div class="container py-4">
  <!-- Direction Reversed: Filter on the Left, Exit on the Right -->
  <div class="d-flex flex-row-reverse justify-content-between align-items-center mb-4">
    
    <!-- Right Side: 3D Exit Button -->
    <a th:href="@{/dashboard}" class="btn btn-light btn-3d px-3">
      <i class="bi bi-box-arrow-left me-1"></i> Exit
    </a>

    <!-- Left Side: Title and Status Filter -->
    <div class="d-flex align-items-center gap-3">
      <h1 class="h3 section-title m-0"><i class="bi bi-box-arrow-in-right me-2"></i>Orders</h1>
      
      <form th:action="@{/orders}" method="get" class="d-flex align-items-center gap-2">
        <label class="text-muted small fw-bold mb-0">STATUS:</label>
        <select class="form-select form-select-3d form-select-sm" name="status" onchange="this.form.submit()" style="min-width: 120px;">
          <option value="" th:selected="${selectedStatus == null}">ALL</option>
          <option th:each="s : ${statuses}"
                  th:value="${s}"
                  th:selected="${s == selectedStatus}"
                  th:text="${s}">STATUS</option>
        </select>
      </form>
    </div>
  </div>

  <!-- 3D Table Style -->
  <div class="card border-0 bg-transparent">
    <div class="table-responsive">
      <table class="table table-hover table-3d align-middle mb-0">
        <thead>
          <tr>
            <th>#</th>
            <th>Reference</th>
            <th>Status</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="o : ${orders}">
            <td th:text="${o.id}">1</td>
            <td class="fw-semibold text-primary" th:text="${o.reference}">ORD-2026-0001</td>
            <td>
              <!-- GitHub Style Badges -->
              <span class="badge rounded-pill px-3 py-2"
                    th:classappend="${o.status.name()=='PENDING' ? ' bg-warning text-dark' :
                                    (o.status.name()=='INTRANSIT' ? ' bg-primary' :
                                     (o.status.name()=='DELIVERED' ? ' bg-success' : ' bg-danger'))}"
                    th:text="${o.status}">PENDING</span>
            </td>
            <td class="text-muted" th:text="${#temporals.format(o.createdAt, 'dd MMM yyyy HH:mm')}">Date</td>
          </tr>
          <tr th:if="${#lists.isEmpty(orders)}">
            <td colspan="4" class="text-center text-muted py-5">
               <i class="bi bi-inbox d-block h2 mb-2"></i> No orders found.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</body>
</html>
