<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments :: head('Record Sale')}"></head>
<body>
<div th:replace="~{fragments :: nav}"></div>

<!-- Remove this if you don't have a "layout" fragment -->
<!-- <div th:replace="~{layout}"></div> -->

<div class="container py-4" style="max-width:900px;">
  <h1 class="h3 mb-3 text-white">Record Sale (No "Create Order")</h1>

  <div class="card shadow-sm bg-dark border-0">
    <div class="card-body">
      <form th:action="@{/staff/purchases}" method="post" th:object="${dto}" class="row g-3">

        <div class="col-md-6">
          <label class="form-label text-secondary">Customer</label>
          <select class="form-select" th:field="*{customerId}" required>
            <option value="">Select customer</option>
            <option th:each="c : ${customers}"
                    th:value="${c.id}"
                    th:text="${c.name + ' (' + c.city + ')'}">
            </option>
          </select>
        </div>

        <div class="col-md-6">
          <label class="form-label text-secondary">Product</label>
          <select class="form-select" th:field="*{productId}" required>
            <option value="">Select product</option>
            <option th:each="p : ${products}"
                    th:value="${p.id}"
                    th:text="${p.brand + ' ' + p.name + ' [' + p.skuId + ']'}">
            </option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label text-secondary">Quantity</label>
          <input class="form-control" type="number" min="1" th:field="*{quantity}" required/>
        </div>

        <div class="col-md-3">
          <label class="form-label text-secondary">Payment Mode</label>
          <select class="form-select" th:field="*{paymentMode}" required>
            <option th:each="m : ${modes}" th:value="${m}" th:text="${m}"></option>
          </select>
        </div>

        <div class="col-md-6">
          <label class="form-label text-secondary">Transaction ID (ONLINE only)</label>
          <input class="form-control" th:field="*{transactionId}" placeholder="TXN-12345"/>
        </div>
 
        <div class="col-12 d-flex gap-2">
          <button class="btn btn-primary" type="submit">Save Sale</button>
          <a class="btn btn-outline-secondary" th:href="@{/dashboard}">Cancel</a>
        </div>

        <div class="col-12">
          <div class="alert alert-info mb-0">
            Sold quantity is computed dynamically (Java 8 Streams) from purchase items.
          </div>
        </div>

      </form>
    </div>
  </div>
</div>

<style>
  .card.bg-dark { background-color: #151515 !important; }
  .form-label.text-secondary { color: #a3a6ad !important; }
  .form-control, .form-select { background-color: #1a1c21; border: 1px solid #2c2f36; color: #e8eaed; }
  .form-control::placeholder { color: #7f8287; }
  .form-control:focus, .form-select:focus {
    border-color: #0d6efd; box-shadow: 0 0 0 0.2rem rgba(13,110,253,.25); background-color: #1f2126; color: #fff;
  }
</style>
</body>
</html>